<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="593px" preserveAspectRatio="none" style="width:525px;height:593px;" version="1.1" viewBox="0 0 525 593" width="525px" zoomAndPan="magnify"><defs><filter height="300%" id="f13dxrcx65nw7s" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f13dxrcx65nw7s)" height="225.9297" style="stroke:#A80036;stroke-width:1.0;" width="10" x="369.5" y="148.5625"/><rect fill="#FFFFFF" filter="url(#f13dxrcx65nw7s)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="497.5" y="403.625"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="26" x2="26" y1="88.2969" y2="509.0234"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="154.5" x2="154.5" y1="88.2969" y2="509.0234"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="374.5" x2="374.5" y1="88.2969" y2="509.0234"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="502.5" x2="502.5" y1="88.2969" y2="509.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="5" y="84.9951">用户A</text><ellipse cx="26.5" cy="15" fill="#FEFECE" filter="url(#f13dxrcx65nw7s)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M26.5,23 L26.5,50 M13.5,31 L39.5,31 M26.5,50 L13.5,65 M26.5,50 L39.5,65 " fill="none" filter="url(#f13dxrcx65nw7s)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="5" y="521.0186">用户A</text><ellipse cx="26.5" cy="534.3203" fill="#FEFECE" filter="url(#f13dxrcx65nw7s)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M26.5,542.3203 L26.5,569.3203 M13.5,550.3203 L39.5,550.3203 M26.5,569.3203 L13.5,584.3203 M26.5,569.3203 L39.5,584.3203 " fill="none" filter="url(#f13dxrcx65nw7s)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f13dxrcx65nw7s)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="84" x="110.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="117.5" y="72.9951">消息接入层</text><rect fill="#FEFECE" filter="url(#f13dxrcx65nw7s)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="84" x="110.5" y="508.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="117.5" y="528.0186">消息接入层</text><rect fill="#FEFECE" filter="url(#f13dxrcx65nw7s)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="84" x="330.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="337.5" y="72.9951">消息处理层</text><rect fill="#FEFECE" filter="url(#f13dxrcx65nw7s)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="84" x="330.5" y="508.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="337.5" y="528.0186">消息处理层</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="480.5" y="84.9951">用户B</text><ellipse cx="502.5" cy="15" fill="#FEFECE" filter="url(#f13dxrcx65nw7s)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M502.5,23 L502.5,50 M489.5,31 L515.5,31 M502.5,50 L489.5,65 M502.5,50 L515.5,65 " fill="none" filter="url(#f13dxrcx65nw7s)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="480.5" y="521.0186">用户B</text><ellipse cx="502.5" cy="534.3203" fill="#FEFECE" filter="url(#f13dxrcx65nw7s)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M502.5,542.3203 L502.5,569.3203 M489.5,550.3203 L515.5,550.3203 M502.5,569.3203 L489.5,584.3203 M502.5,569.3203 L515.5,584.3203 " fill="none" filter="url(#f13dxrcx65nw7s)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FFFFFF" filter="url(#f13dxrcx65nw7s)" height="225.9297" style="stroke:#A80036;stroke-width:1.0;" width="10" x="369.5" y="148.5625"/><rect fill="#FFFFFF" filter="url(#f13dxrcx65nw7s)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="497.5" y="403.625"/><polygon fill="#A80036" points="142.5,115.4297,152.5,119.4297,142.5,123.4297,146.5,119.4297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="26.5" x2="148.5" y1="119.4297" y2="119.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="33.5" y="114.3638">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="46.5" y="114.3638">发送消息</text><line style="stroke:#A80036;stroke-width:1.0;" x1="367.5" x2="357.5" y1="148.5625" y2="144.5625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="367.5" x2="357.5" y1="148.5625" y2="152.5625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="154.5" x2="368.5" y1="148.5625" y2="148.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="161.5" y="143.4966">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="174.5" y="143.4966">转发消息</text><path d="M384,161.5625 L384,201.5625 L504,201.5625 L504,171.5625 L494,161.5625 L384,161.5625 " fill="#FBFB77" filter="url(#f13dxrcx65nw7s)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M494,161.5625 L494,171.5625 L504,171.5625 L494,161.5625 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="390" y="178.6294">离线消息存Redis</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="390" y="193.7622">定时刷到mysql</text><line style="stroke:#A80036;stroke-width:1.0;" x1="379.5" x2="421.5" y1="231.9609" y2="231.9609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="421.5" x2="421.5" y1="231.9609" y2="244.9609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="380.5" x2="421.5" y1="244.9609" y2="244.9609"/><polygon fill="#A80036" points="390.5,240.9609,380.5,244.9609,390.5,248.9609,386.5,244.9609" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="386.5" y="226.895">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="399.5" y="226.895">持久化消息</text><polygon fill="#A80036" points="165.5,270.0938,155.5,274.0938,165.5,278.0938,161.5,274.0938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159.5" x2="368.5" y1="274.0938" y2="274.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="171.5" y="269.0278">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22" x="184.5" y="269.0278">ack</text><polygon fill="#A80036" points="37.5,299.2266,27.5,303.2266,37.5,307.2266,33.5,303.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="31.5" x2="153.5" y1="303.2266" y2="303.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="43.5" y="298.1606">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22" x="56.5" y="298.1606">ack</text><line style="stroke:#A80036;stroke-width:1.0;" x1="379.5" x2="421.5" y1="332.3594" y2="332.3594"/><line style="stroke:#A80036;stroke-width:1.0;" x1="421.5" x2="421.5" y1="332.3594" y2="345.3594"/><line style="stroke:#A80036;stroke-width:1.0;" x1="380.5" x2="421.5" y1="345.3594" y2="345.3594"/><polygon fill="#A80036" points="390.5,341.3594,380.5,345.3594,390.5,349.3594,386.5,345.3594" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="386.5" y="327.2935">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="399.5" y="327.2935">获取群成员列表</text><line style="stroke:#A80036;stroke-width:1.0;" x1="154.5" x2="164.5" y1="374.4922" y2="370.4922"/><line style="stroke:#A80036;stroke-width:1.0;" x1="154.5" x2="164.5" y1="374.4922" y2="378.4922"/><line style="stroke:#A80036;stroke-width:1.0;" x1="154.5" x2="373.5" y1="374.4922" y2="374.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="171.5" y="369.4263">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="184.5" y="369.4263">转发</text><polygon fill="#A80036" points="485.5,399.625,495.5,403.625,485.5,407.625,489.5,403.625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="154.5" x2="491.5" y1="403.625" y2="403.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="161.5" y="398.5591">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="174.5" y="398.5591">发送消息</text><polygon fill="#A80036" points="165.5,428.7578,155.5,432.7578,165.5,436.7578,161.5,432.7578" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159.5" x2="501.5" y1="432.7578" y2="432.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="171.5" y="427.6919">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="184.5" y="427.6919">已读ack</text><polygon fill="#A80036" points="37.5,457.8906,27.5,461.8906,37.5,465.8906,33.5,461.8906" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="31.5" x2="153.5" y1="461.8906" y2="461.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="43.5" y="456.8247">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="65.5" y="456.8247">用户b已读ack</text><line style="stroke:#A80036;stroke-width:1.0;" x1="372.5" x2="362.5" y1="491.0234" y2="487.0234"/><line style="stroke:#A80036;stroke-width:1.0;" x1="372.5" x2="362.5" y1="491.0234" y2="495.0234"/><line style="stroke:#A80036;stroke-width:1.0;" x1="154.5" x2="373.5" y1="491.0234" y2="491.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="161.5" y="485.9575">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="183.5" y="485.9575">更新群成员列表中用户B的ack</text></g></svg>