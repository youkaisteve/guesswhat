<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="593px" preserveAspectRatio="none" style="width:390px;height:593px;" version="1.1" viewBox="0 0 390 593" width="390px" zoomAndPan="magnify"><defs><filter height="300%" id="f16z4a2u0nhnos" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f16z4a2u0nhnos)" height="225.9297" style="stroke:#A80036;stroke-width:1.0;" width="10" x="247.5" y="148.5625"/><rect fill="#FFFFFF" filter="url(#f16z4a2u0nhnos)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="362.5" y="403.625"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="26" x2="26" y1="88.2969" y2="509.0234"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="154.5" x2="154.5" y1="88.2969" y2="509.0234"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="252.5" x2="252.5" y1="88.2969" y2="509.0234"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="367.5" x2="367.5" y1="88.2969" y2="509.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="5" y="84.9951">用户A</text><ellipse cx="26.5" cy="15" fill="#FEFECE" filter="url(#f16z4a2u0nhnos)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M26.5,23 L26.5,50 M13.5,31 L39.5,31 M26.5,50 L13.5,65 M26.5,50 L39.5,65 " fill="none" filter="url(#f16z4a2u0nhnos)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="5" y="521.0186">用户A</text><ellipse cx="26.5" cy="534.3203" fill="#FEFECE" filter="url(#f16z4a2u0nhnos)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M26.5,542.3203 L26.5,569.3203 M13.5,550.3203 L39.5,550.3203 M26.5,569.3203 L13.5,584.3203 M26.5,569.3203 L39.5,584.3203 " fill="none" filter="url(#f16z4a2u0nhnos)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f16z4a2u0nhnos)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="84" x="110.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="117.5" y="72.9951">消息接入层</text><rect fill="#FEFECE" filter="url(#f16z4a2u0nhnos)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="84" x="110.5" y="508.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="117.5" y="528.0186">消息接入层</text><rect fill="#FEFECE" filter="url(#f16z4a2u0nhnos)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="84" x="208.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="215.5" y="72.9951">消息处理层</text><rect fill="#FEFECE" filter="url(#f16z4a2u0nhnos)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="84" x="208.5" y="508.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="215.5" y="528.0186">消息处理层</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="345.5" y="84.9951">用户B</text><ellipse cx="367.5" cy="15" fill="#FEFECE" filter="url(#f16z4a2u0nhnos)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M367.5,23 L367.5,50 M354.5,31 L380.5,31 M367.5,50 L354.5,65 M367.5,50 L380.5,65 " fill="none" filter="url(#f16z4a2u0nhnos)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="345.5" y="521.0186">用户B</text><ellipse cx="367.5" cy="534.3203" fill="#FEFECE" filter="url(#f16z4a2u0nhnos)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M367.5,542.3203 L367.5,569.3203 M354.5,550.3203 L380.5,550.3203 M367.5,569.3203 L354.5,584.3203 M367.5,569.3203 L380.5,584.3203 " fill="none" filter="url(#f16z4a2u0nhnos)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FFFFFF" filter="url(#f16z4a2u0nhnos)" height="225.9297" style="stroke:#A80036;stroke-width:1.0;" width="10" x="247.5" y="148.5625"/><rect fill="#FFFFFF" filter="url(#f16z4a2u0nhnos)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="362.5" y="403.625"/><polygon fill="#A80036" points="142.5,115.4297,152.5,119.4297,142.5,123.4297,146.5,119.4297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="26.5" x2="148.5" y1="119.4297" y2="119.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="33.5" y="114.3638">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="46.5" y="114.3638">发送消息</text><line style="stroke:#A80036;stroke-width:1.0;" x1="245.5" x2="235.5" y1="148.5625" y2="144.5625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="245.5" x2="235.5" y1="148.5625" y2="152.5625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="154.5" x2="246.5" y1="148.5625" y2="148.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="161.5" y="143.4966">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="174.5" y="143.4966">转发消息</text><path d="M262,161.5625 L262,201.5625 L373,201.5625 L373,171.5625 L363,161.5625 L262,161.5625 " fill="#FBFB77" filter="url(#f16z4a2u0nhnos)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M363,161.5625 L363,171.5625 L373,171.5625 L363,161.5625 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="268" y="178.6294">离线消息Redis</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="268" y="193.7622">定时刷到mysql</text><line style="stroke:#A80036;stroke-width:1.0;" x1="257.5" x2="299.5" y1="231.9609" y2="231.9609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="299.5" x2="299.5" y1="231.9609" y2="244.9609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="258.5" x2="299.5" y1="244.9609" y2="244.9609"/><polygon fill="#A80036" points="268.5,240.9609,258.5,244.9609,268.5,248.9609,264.5,244.9609" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="264.5" y="226.895">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="277.5" y="226.895">持久化消息</text><polygon fill="#A80036" points="165.5,270.0938,155.5,274.0938,165.5,278.0938,161.5,274.0938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159.5" x2="246.5" y1="274.0938" y2="274.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="171.5" y="269.0278">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22" x="184.5" y="269.0278">ack</text><polygon fill="#A80036" points="37.5,299.2266,27.5,303.2266,37.5,307.2266,33.5,303.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="31.5" x2="153.5" y1="303.2266" y2="303.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="43.5" y="298.1606">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22" x="56.5" y="298.1606">ack</text><line style="stroke:#A80036;stroke-width:1.0;" x1="257.5" x2="299.5" y1="332.3594" y2="332.3594"/><line style="stroke:#A80036;stroke-width:1.0;" x1="299.5" x2="299.5" y1="332.3594" y2="345.3594"/><line style="stroke:#A80036;stroke-width:1.0;" x1="258.5" x2="299.5" y1="345.3594" y2="345.3594"/><polygon fill="#A80036" points="268.5,341.3594,258.5,345.3594,268.5,349.3594,264.5,345.3594" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="264.5" y="327.2935">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="277.5" y="327.2935">目标用户寻址</text><line style="stroke:#A80036;stroke-width:1.0;" x1="154.5" x2="164.5" y1="374.4922" y2="370.4922"/><line style="stroke:#A80036;stroke-width:1.0;" x1="154.5" x2="164.5" y1="374.4922" y2="378.4922"/><line style="stroke:#A80036;stroke-width:1.0;" x1="154.5" x2="251.5" y1="374.4922" y2="374.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="171.5" y="369.4263">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="184.5" y="369.4263">转发</text><polygon fill="#A80036" points="350.5,399.625,360.5,403.625,350.5,407.625,354.5,403.625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="154.5" x2="356.5" y1="403.625" y2="403.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="161.5" y="398.5591">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="174.5" y="398.5591">发送消息</text><polygon fill="#A80036" points="165.5,428.7578,155.5,432.7578,165.5,436.7578,161.5,432.7578" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159.5" x2="366.5" y1="432.7578" y2="432.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="171.5" y="427.6919">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="184.5" y="427.6919">已读ack</text><polygon fill="#A80036" points="37.5,457.8906,27.5,461.8906,37.5,465.8906,33.5,461.8906" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="31.5" x2="153.5" y1="461.8906" y2="461.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="43.5" y="456.8247">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="65.5" y="456.8247">用户b已读ack</text><line style="stroke:#A80036;stroke-width:1.0;" x1="250.5" x2="240.5" y1="491.0234" y2="487.0234"/><line style="stroke:#A80036;stroke-width:1.0;" x1="250.5" x2="240.5" y1="491.0234" y2="495.0234"/><line style="stroke:#A80036;stroke-width:1.0;" x1="154.5" x2="251.5" y1="491.0234" y2="491.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="161.5" y="485.9575">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="183.5" y="485.9575">更新ack</text></g></svg>